-- Database: store

-- DROP DATABASE store;
	
-- #100DaysOfCode
-- INNER JOINT PART 2

SELECT * FROM customers;
SELECT * FROM orders;
SELECT * FROM products;
SELECT * FROM address;

SELECT cu.id, cu.first_name, cu.last_name, o.quantity, o.price FROM orders o
FULL JOIN customers cu ON o.customer_id = cu.id
WHERE cu.first_name = 'John'; 

SELECT cu.first_name, cu.last_name, o.quantity, o.price, o.order_date FROM orders o
FULL JOIN customers cu ON o.customer_id = cu.id
WHERE cu.id IN (2,4,6,8,9)
AND o.quantity > 1
ORDER BY o.order_date ASC;


-- 1. Select the name from the products table and the order_date from the orders table.
SELECT p.name, o.order_date FROM products p
INNER JOIN orders o ON p.id = o.product_id;

-- 2. Select the first_name and last_name from the customers table and the id 
-- from the orders table for orders placed in February 2017, ordered by customer last_name alphabetically Z to A. 

SELECT cu.first_name, cu.last_name, o.id FROM customers cu
INNER JOIN orders o ON cu.id=o.customer_id  
WHERE o.order_date BETWEEN '20170201' AND '20170228'
ORDER BY cu.last_name DESC;

-- 3. Select date_joined from the customers table and postcode from the address table
-- where city is Brighton, ordered by customers first_name alphabetically A to Z. 


SELECT cu.date_joined, a.postcode FROM customers cu
INNER JOIN address a ON cu.address_id =a.id
WHERE a.city IN ('Brighton')
ORDER BY cu.first_name ASC;